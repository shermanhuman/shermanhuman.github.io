<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sherman Boyd - C64 Resume</title>
    <script src="https://unpkg.com/vue@next"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=VT323&display=swap">
    <style>
        body {
            background-color: #4040e0;
            color: #a0a0ff;
            font-family: 'VT323', monospace;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }
        #app {
            width: 100%;
            max-width: 640px;
            white-space: pre-wrap;
            outline: none;
        }
        .selected {
            background-color: #a0a0ff;
            color: #4040e0;
        }
    </style>
</head>
<body>
    <div id="app">
        <div v-if="currentScreen === 'boot'">
            {{ bootSequence }}
        </div>

        <div v-if="currentScreen === 'menu'" @keydown="handleKeydown" tabindex="0" ref="menuRef">
            <div v-for="(item, index) in menuItems" :key="index" :class="{ selected: index === selectedIndex }">
                {{ index + 1 }}. {{ item.label }}
            </div>
            <div style="margin-top: 20px;">USE ARROW KEYS TO NAVIGATE, ENTER TO SELECT, OR PRESS NUMBER KEY</div>
        </div>

        <div v-else-if="currentScreen === 'resume'">
            <div v-html="parsedResumeContent"></div>
            <div @click="returnToMenu" style="cursor: pointer; margin-top: 20px;">RETURN TO MAIN MENU</div>
        </div>

        <div v-else-if="currentScreen === 'blogMenu'" @keydown="handleKeydown" tabindex="0" ref="blogMenuRef">
            <h2>BLOG POSTS:</h2>
            <div v-for="(post, index) in blogPosts" :key="index" :class="{ selected: index === selectedIndex }">
                {{ index + 1 }}. {{ post.title }}
            </div>
            <div :class="{ selected: selectedIndex === blogPosts.length }">
                {{ blogPosts.length + 1 }}. RETURN TO MAIN MENU
            </div>
            <div style="margin-top: 20px;">USE ARROW KEYS TO NAVIGATE, ENTER TO SELECT, OR PRESS NUMBER KEY</div>
        </div>

        <div v-else-if="currentScreen === 'blogPost'">
            <div v-html="parsedBlogContent"></div>
            <div @click="returnToBlogMenu" style="cursor: pointer; margin-top: 20px;">RETURN TO BLOG MENU</div>
        </div>
    </div>

    <script>
        const app = Vue.createApp({
            data() {
                return {
                    currentScreen: 'boot',
                    bootSequence: '',
                    menuItems: [
                        { label: 'VIEW RESUME', action: 'viewResume' },
                        { label: 'VIEW BLOG', action: 'viewBlog' },
                    ],
                    selectedIndex: 0,
                    resumeContent: '',
                    blogPosts: [],
                    blogContent: '',
                };
            },
            methods: {
                async simulateBoot() {
                    const bootLines = [
                        "**** COMMODORE 64 BASIC V2 ****",
                        "64K RAM SYSTEM  38911 BASIC BYTES FREE",
                        "READY.",
                        "LOAD \"MENU\",8,1",
                        "SEARCHING FOR MENU",
                        "LOADING",
                        "READY.",
                        "RUN"
                    ];

                    for (let i = 0; i < bootLines.length; i++) {
                        this.bootSequence += bootLines[i] + '\n';
                        if (i >= 3) {
                            await new Promise(resolve => setTimeout(resolve, 1000));
                        }
                    }
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    this.currentScreen = 'menu';
                },
                handleKeydown(event) {
                    const maxIndex = this.currentScreen === 'menu' ? this.menuItems.length - 1 : this.blogPosts.length;
                    switch (event.key) {
                        case 'ArrowUp':
                            this.selectedIndex = (this.selectedIndex - 1 + maxIndex + 1) % (maxIndex + 1);
                            break;
                        case 'ArrowDown':
                            this.selectedIndex = (this.selectedIndex + 1) % (maxIndex + 1);
                            break;
                        case 'Enter':
                            if (this.currentScreen === 'menu') {
                                this.handleMenuSelection(this.menuItems[this.selectedIndex].action);
                            } else {
                                this.handleBlogSelection(this.selectedIndex);
                            }
                            break;
                        default:
                            if (event.key >= '1' && event.key <= (maxIndex + 1).toString()) {
                                const index = parseInt(event.key) - 1;
                                if (index <= maxIndex) {
                                    this.selectedIndex = index;
                                    if (this.currentScreen === 'menu') {
                                        this.handleMenuSelection(this.menuItems[index].action);
                                    } else {
                                        this.handleBlogSelection(index);
                                    }
                                }
                            }
                    }
                },
                async handleMenuSelection(action) {
                    if (action === 'viewResume') {
                        await this.loadResume();
                    } else if (action === 'viewBlog') {
                        await this.loadBlogPosts();
                    }
                },
                async loadResume() {
                    this.currentScreen = 'boot';
                    this.bootSequence = 'LOAD "RESUME",8,1\nSEARCHING FOR RESUME\nLOADING\n';
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    try {
                        const response = await fetch('resume.md');
                        this.resumeContent = await response.text();
                        this.currentScreen = 'resume';
                    } catch (error) {
                        console.error('Error loading resume:', error);
                        this.bootSequence += 'ERROR LOADING RESUME\n';
                        await new Promise(resolve => setTimeout(resolve, 1000));
                        this.currentScreen = 'menu';
                    }
                },
                async loadBlogPosts() {
                    this.currentScreen = 'boot';
                    this.bootSequence = 'LOAD "BLOG",8,1\nSEARCHING FOR BLOG\nLOADING\n';
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    try {
                        const posts = ['first-post.md', 'second-post.md', 'third-post.md'];
                        this.blogPosts = await Promise.all(posts.map(async (post) => {
                            const response = await fetch(post);
                            const content = await response.text();
                            const title = content.split('\n')[0].replace('# ', '');
                            return { title, filename: post };
                        }));
                        this.currentScreen = 'blogMenu';
                        this.selectedIndex = 0;
                    } catch (error) {
                        console.error('Error loading blog posts:', error);
                        this.bootSequence += 'ERROR LOADING BLOG POSTS\n';
                        await new Promise(resolve => setTimeout(resolve, 1000));
                        this.currentScreen = 'menu';
                    }
                },
                async handleBlogSelection(index) {
                    if (index === this.blogPosts.length) {
                        this.returnToMenu();
                    } else {
                        await this.loadBlogPost(this.blogPosts[index].filename);
                    }
                },
                async loadBlogPost(filename) {
                    this.currentScreen = 'boot';
                    this.bootSequence = `LOAD "${filename}",8,1\nSEARCHING FOR ${filename}\nLOADING\n`;
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    try {
                        const response = await fetch(filename);
                        this.blogContent = await response.text();
                        this.currentScreen = 'blogPost';
                    } catch (error) {
                        console.error('Error loading blog post:', error);
                        this.bootSequence += 'ERROR LOADING BLOG POST\n';
                        await new Promise(resolve => setTimeout(resolve, 1000));
                        this.currentScreen = 'blogMenu';
                    }
                },
                returnToMenu() {
                    this.currentScreen = 'menu';
                    this.selectedIndex = 0;
                },
                returnToBlogMenu() {
                    this.currentScreen = 'blogMenu';
                    this.selectedIndex = 0;
                },
            },
            computed: {
                parsedResumeContent() {
                    return marked(this.resumeContent);
                },
                parsedBlogContent() {
                    return marked(this.blogContent);
                },
            },
            mounted() {
                this.simulateBoot();
            },
        });

        app.mount('#app');
    </script>
</body>
</html>
