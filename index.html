<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sherman Boyd - C64 Resume and Blog</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        @font-face {
            font-family: 'C64';
            src: url('https://cdn.jsdelivr.net/gh/stylebits/webfonts@v1.0.0/c64.ttf') format('truetype');
        }
        body {
            background-color: #4040e0;
            color: #a0a0ff;
            font-family: 'C64', monospace;
            padding: 20px;
            line-height: 1.6;
        }
        #app {
            max-width: 800px;
            margin: 0 auto;
        }
        .menu-item {
            padding: 5px;
            cursor: pointer;
        }
        .menu-item.active {
            background-color: #a0a0ff;
            color: #4040e0;
        }
        .return-menu {
            margin-top: 20px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="app">
        <div v-if="currentScreen === 'boot'">
            <p v-for="(line, index) in bootLines.slice(0, bootPhase)" :key="index">{{ line }}</p>
        </div>
        <div v-else-if="currentScreen === 'menu'" @keydown="handleKeydown" tabindex="0" ref="menuRef">
            <p v-for="(item, index) in menuItems" :key="index" 
               :class="['menu-item', { active: index === activeMenuItem }]">
                {{ index + 1 }}. {{ item.label }}
            </p>
            <p>USE ARROW KEYS TO NAVIGATE, ENTER TO SELECT, OR PRESS NUMBER KEY</p>
        </div>
        <div v-else-if="currentScreen === 'resume'">
            <div v-html="parsedResumeContent"></div>
            <p class="return-menu" @click="returnToMenu" tabindex="0" @keydown.enter="returnToMenu">RETURN TO MAIN MENU</p>
        </div>
        <div v-else-if="currentScreen === 'blogMenu'" @keydown="handleKeydown" tabindex="0" ref="blogMenuRef">
            <h2>BLOG POSTS:</h2>
            <p v-for="(post, index) in blogPosts" :key="index"
               :class="['menu-item', { active: index === activeMenuItem }]">
                {{ index + 1 }}. {{ post.title }}
            </p>
            <p>USE ARROW KEYS TO NAVIGATE, ENTER TO SELECT, OR PRESS NUMBER KEY</p>
            <p class="menu-item" :class="{ active: activeMenuItem === blogPosts.length }">
                {{ blogPosts.length + 1 }}. RETURN TO MAIN MENU
            </p>
        </div>
        <div v-else-if="currentScreen === 'blogPost'">
            <div v-html="parsedBlogContent"></div>
            <p class="return-menu" @click="returnToMenu" tabindex="0" @keydown.enter="returnToMenu">RETURN TO MAIN MENU</p>
        </div>
    </div>

    <script>
        const { createApp, ref, computed, onMounted, nextTick } = Vue;

        createApp({
            setup() {
                const currentScreen = ref('boot');
                const bootPhase = ref(0);
                const bootLines = [
                    '**** COMMODORE 64 BASIC V2 ****',
                    '64K RAM SYSTEM 38911 BASIC BYTES FREE',
                    'READY.',
                    'LOAD "MAIN-MENU",8,1',
                    'SEARCHING FOR MAIN-MENU',
                    'LOADING',
                    'READY.'
                ];
                const resumeContent = ref('');
                const blogPosts = [
                    { filename: 'first-post.md', title: 'My First Blog Post' },
                    { filename: 'second-post.md', title: 'Adventures in Coding' },
                    { filename: 'third-post.md', title: 'Reflections on Technology' }
                ];

                const menuItems = [
                    { label: 'VIEW RESUME', action: () => showResume() },
                    { label: 'VIEW BLOG', action: () => showBlogMenu() }
                ];

                const currentBlogContent = ref('');
                const activeMenuItem = ref(0);
                const menuRef = ref(null);
                const blogMenuRef = ref(null);

                const parsedResumeContent = computed(() => marked.parse(resumeContent.value));
                const parsedBlogContent = computed(() => marked.parse(currentBlogContent.value));

                function boot() {
                    if (bootPhase.value < bootLines.length) {
                        bootPhase.value++;
                        setTimeout(boot, 2000); // 2 seconds per line
                    } else {
                        currentScreen.value = 'menu';
                        nextTick(() => {
                            menuRef.value.focus();
                        });
                    }
                }

                async function showResume() {
                    try {
                        const response = await fetch('resume.md');
                        resumeContent.value = await response.text();
                        currentScreen.value = 'resume';
                    } catch (error) {
                        console.error('Failed to load resume:', error);
                    }
                }

                function showBlogMenu() {
                    currentScreen.value = 'blogMenu';
                    activeMenuItem.value = 0;
                    nextTick(() => {
                        blogMenuRef.value.focus();
                    });
                }

                function showBlogPost(filename) {
                    currentBlogContent.value = `# ${filename.replace('.md', '')}\n\nThis is the content of the blog post.`;
                    currentScreen.value = 'blogPost';
                }

                function returnToMenu() {
                    currentScreen.value = 'menu';
                    activeMenuItem.value = 0;
                    nextTick(() => {
                        menuRef.value.focus();
                    });
                }

                function handleKeydown(event) {
                    const maxIndex = currentScreen.value === 'menu' 
                        ? menuItems.length - 1 
                        : blogPosts.length;

                    switch(event.key) {
                        case 'ArrowUp':
                        case 'ArrowLeft':
                            activeMenuItem.value = (activeMenuItem.value - 1 + maxIndex + 1) % (maxIndex + 1);
                            break;
                        case 'ArrowDown':
                        case 'ArrowRight':
                            activeMenuItem.value = (activeMenuItem.value + 1) % (maxIndex + 1);
                            break;
                        case 'Enter':
                            if (currentScreen.value === 'menu') {
                                menuItems[activeMenuItem.value].action();
                            } else if (currentScreen.value === 'blogMenu') {
                                if (activeMenuItem.value === blogPosts.length) {
                                    returnToMenu();
                                } else {
                                    showBlogPost(blogPosts[activeMenuItem.value].filename);
                                }
                            }
                            break;
                        default:
                            if (event.key >= '1' && event.key <= (maxIndex + 1).toString()) {
                                activeMenuItem.value = parseInt(event.key) - 1;
                                if (currentScreen.value === 'menu') {
                                    menuItems[activeMenuItem.value].action();
                                } else if (currentScreen.value === 'blogMenu') {
                                    if (activeMenuItem.value === blogPosts.length) {
                                        returnToMenu();
                                    } else {
                                        showBlogPost(blogPosts[activeMenuItem.value].filename);
                                    }
                                }
                            }
                    }
                }

                onMounted(() => {
                    boot();
                });

                return {
                    currentScreen,
                    bootLines,
                    bootPhase,
                    parsedResumeContent,
                    blogPosts,
                    parsedBlogContent,
                    menuItems,
                    activeMenuItem,
                    handleKeydown,
                    menuRef,
                    blogMenuRef,
                    returnToMenu
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
